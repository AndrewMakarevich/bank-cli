(()=>{"use strict";var t,e,r={},n={};function o(t){var e=n[t];if(void 0!==e)return e.exports;var i=n[t]={exports:{}};return r[t](i,i.exports,o),i.exports}e=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,o.t=function(r,n){if(1&n&&(r=this(r)),8&n)return r;if("object"==typeof r&&r){if(4&n&&r.__esModule)return r;if(16&n&&"function"==typeof r.then)return r}var i=Object.create(null);o.r(i);var a={};t=t||[null,e({}),e([]),e(e)];for(var s=2&n&&r;"object"==typeof s&&!~t.indexOf(s);s=e(s))Object.getOwnPropertyNames(s).forEach((t=>a[t]=()=>r[t]));return a.default=()=>r,o.d(i,a),i},o.d=(t,e)=>{for(var r in e)o.o(e,r)&&!o.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};const i=function(){function t(){this._subscriptions=new Map}return Object.defineProperty(t.prototype,"subscriptions",{get:function(){return this._subscriptions},enumerable:!1,configurable:!0}),t.prototype.observe=function(t,e){var r=this._subscriptions.get(t);r||(this._subscriptions.set(t,[]),r=this._subscriptions.get(t)),null==r||r.push(e)},t.prototype.unobserve=function(t,e){var r=this._subscriptions.get(t);null==r||r.filter((function(t){return t!==e}))},t.prototype.notify=function(t,e){var r;null===(r=this._subscriptions.get(t))||void 0===r||r.forEach((function(t){t.notify(e)}))},t}(),a=function(){function t(t){this.observer=t}return Object.defineProperty(t.prototype,"subscriptions",{get:function(){return this.observer.subscriptions},enumerable:!1,configurable:!0}),t.prototype.notify=function(t,e){this.observer.notify(t,e)},t.prototype.observe=function(t,e){this.observer.observe(t,e)},t.prototype.unobserve=function(t,e){this.observer.unobserve(t,e)},t}(),s=function(){function t(t){this.command=t}return Object.defineProperty(t.prototype,"name",{get:function(){return this.command.name},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"description",{get:function(){return this.command.description},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.command.options},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"arguments",{get:function(){return this.command.arguments},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"observer",{get:function(){return this.command.observer},set:function(t){this.command.observer=t},enumerable:!1,configurable:!0}),t.prototype.addOption=function(t){return this.command.addOption(t)},t.prototype.addArgument=function(t){return this.command.addArgument(t)},t.prototype.handle=function(t){this.command.handle(t)},t}();var c=function(){function t(t){this._observer=t,this._existCommands=new Map}return Object.defineProperty(t.prototype,"existCommands",{get:function(){return this._existCommands},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"observer",{get:function(){return this._observer},enumerable:!1,configurable:!0}),t.prototype.addCommand=function(t){var e=new s(t);if(this._existCommands.get(e.name))throw Error("Command with such name ".concat(e.name," is already exists"));return e.observer=this._observer,this._existCommands.set(e.name,t),e},t.prototype.parseAsOption=function(t,e){var r,n,o=t.match(/(?<=(--|-))(?<optName>[a-zA-Z0-9]+)(=(?<optArg>[a-zA-Z0-9]+))?/);if(null==o?void 0:o.groups){for(var i=o.groups,a=i.optName,s=i.optArg,c=!1,u=0,p=null!==(n=e.options)&&void 0!==n?n:[];u<p.length;u++){var l=p[u];if(l.availableNames.includes(a)){c=!0,a=l.mainName;break}}return c?((r={})[a]=s||!0,r):null}return null},t.prototype.parseAsArgument=function(t,e){var r;if(/^[a-zA-Z0-9]+$/.test(t)){var n=e.shift();return n?((r={})[n]=t,r):null}return null},t.prototype.parseArgv=function(){var t=this,e=process.argv.slice(2),r=!1,n="";e[0].startsWith("-")||e[0].startsWith("--")?r=!0:n=e[0];var o=this.existCommands.get(n);if(!o)throw Error("Icorrect command");var i=function(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))}([],o.arguments.map((function(t){return t.name})),!0),a={},s={};return e.forEach((function(e,n){if(0!==n||r){var c=t.parseAsOption(e,o);if(c){var u=Object.keys(c)[0];if(!a[u])return a[u]=c[u]}if(0!==i.length){var p=t.parseAsArgument(e,i);if(p){var l=Object.keys(p)[0];s[l]||(s[l]=p[l])}}}})),{command:n,givenOpts:a,givenArgs:s}},t.prototype.parse=function(){var t=this.parseArgv(),e=t.command,r=t.givenArgs,n=t.givenOpts;return this._observer.notify(e,{command:e,args:r,opts:n}),t},t}();const u=c,p=function(){function t(t){this.parser=t}return Object.defineProperty(t.prototype,"existCommands",{get:function(){return this.parser.existCommands},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"observer",{get:function(){return this.parser.observer},enumerable:!1,configurable:!0}),t.prototype.addCommand=function(t){return this.parser.addCommand(t)},t.prototype.parse=function(){return this.parser.parse()},t}(),l=require("tty");var d=o.t(l,2);const{env:m={},argv:g=[],platform:f=""}="undefined"==typeof process?{}:process,h="NO_COLOR"in m||g.includes("--no-color"),b="FORCE_COLOR"in m||g.includes("--color"),y="win32"===f,v="dumb"===m.TERM,w=d&&l.isatty&&l.isatty(1)&&m.TERM&&!v,O=!h&&(b||y&&!v||w||"CI"in m&&("GITHUB_ACTIONS"in m||"GITLAB_CI"in m||"CIRCLECI"in m)),B=(t,e,r,n,o=e.substring(0,t)+n,i=e.substring(t+r.length),a=i.indexOf(r))=>o+(a<0?i:B(a,i,r,n)),C=(t,e,r)=>((t,e,r=t,n=t.length+1)=>o=>o||""!==o&&void 0!==o?((t,e,r,n,o)=>t<0?r+e+n:r+B(t,e,n,o)+n)((""+o).indexOf(e,n),o,t,e,r):"")(`[${t}m`,`[${e}m`,r),P={reset:C(0,0),bold:C(1,22,"[22m[1m"),dim:C(2,22,"[22m[2m"),italic:C(3,23),underline:C(4,24),inverse:C(7,27),hidden:C(8,28),strikethrough:C(9,29),black:C(30,39),red:C(31,39),green:C(32,39),yellow:C(33,39),blue:C(34,39),magenta:C(35,39),cyan:C(36,39),white:C(37,39),gray:C(90,39),bgBlack:C(40,49),bgRed:C(41,49),bgGreen:C(42,49),bgYellow:C(43,49),bgBlue:C(44,49),bgMagenta:C(45,49),bgCyan:C(46,49),bgWhite:C(47,49),blackBright:C(90,39),redBright:C(91,39),greenBright:C(92,39),yellowBright:C(93,39),blueBright:C(94,39),magentaBright:C(95,39),cyanBright:C(96,39),whiteBright:C(97,39),bgBlackBright:C(100,49),bgRedBright:C(101,49),bgGreenBright:C(102,49),bgYellowBright:C(103,49),bgBlueBright:C(104,49),bgMagentaBright:C(105,49),bgCyanBright:C(106,49),bgWhiteBright:C(107,49)},{reset:A,bold:j,dim:_,italic:x,underline:S,inverse:k,hidden:M,strikethrough:E,black:N,red:H,green:T,yellow:I,blue:R,magenta:W,cyan:L,white:G,gray:z,bgBlack:Y,bgRed:Z,bgGreen:D,bgYellow:F,bgBlue:$,bgMagenta:q,bgCyan:U,bgWhite:J,blackBright:K,redBright:Q,greenBright:V,yellowBright:X,blueBright:tt,magentaBright:et,cyanBright:rt,whiteBright:nt,bgBlackBright:ot,bgRedBright:it,bgGreenBright:at,bgYellowBright:st,bgBlueBright:ct,bgMagentaBright:ut,bgCyanBright:pt,bgWhiteBright:lt}=(({useColor:t=O}={})=>t?P:Object.keys(P).reduce(((t,e)=>({...t,[e]:String})),{}))(),dt=function(t,e){this.name=t,this.description=e},mt=function(){function t(t){this.callback=t}return t.prototype.notify=function(t){this.callback(t)},t}(),gt=function(){function t(t,e){this.name=t,this.description=e,this.opts=[],this.args=[],this._observer=null}return Object.defineProperty(t.prototype,"options",{get:function(){return this.opts},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"arguments",{get:function(){return this.args},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"observer",{get:function(){return this._observer},set:function(t){this._observer=t},enumerable:!1,configurable:!0}),t.prototype.addOption=function(t){return this.opts.push(t),this},t.prototype.addArgument=function(t){return this.args.push(t),this},t.prototype.handle=function(t){this._observer&&this._observer.observe(this.name,new mt(t))},t}(),ft=function(){function t(t,e,r){void 0===t&&(t=""),void 0===e&&(e=""),this.name=t,this.description=e,this.parser=null!=r?r:null}return t.prototype.addHelpTableCommand=function(){this.parser&&this.parser.addCommand(new gt("help","Shows help table")).addArgument(new dt("commandHelpWith")).handle(this.onShowHelpTable.bind(this))},t.prototype.onShowHelpTable=function(t){var e=this;if(this.parser){t.command,t.opts;var r=t.args.commandHelpWith;if(r){var n=this.parser.existCommands.get(r);if(!n)return void console.log(Q("Such command(".concat(String(r),") doesn't exists")));var o=this.getCommandHelpString(n);console.log(o)}else{var i="Help node fore the ".concat(this.getProgramHeaderStr()),a=Array.from(this.parser.existCommands.keys()).map((function(t){var r,n=null===(r=e.parser)||void 0===r?void 0:r.existCommands.get(t);return n?e.getCommandHelpString(n):""})).join("---------------------------------------------------\n");console.log("".concat(Q(i),"\n\n").concat(a))}}},t.prototype.getProgramHeaderStr=function(){return"".concat(String(this.name)," Application\nDescription:").concat(String(this.description))},t.prototype.getCommandHelpString=function(t){var e=this,r=t.name,n=t.description,o=t.arguments,i=t.options,a="".concat(R("Command")," ").concat(I(r)," ").concat(o.map((function(t){return"<".concat(V(t.name),">")})).join(" ")," ").concat(null!=n?n:""," \n\n"),s=o.map((function(t){return e.getArgumentStr(t)})).join(""),c=s.trim()?H("Arguments:\n")+s+"\n":"",u=i.map((function(t){return e.getOptionStr(t)})).join("");return a+c+(u?W("Options(starts with - or --):\n")+u:"")},t.prototype.getOptionStr=function(t){var e;return"  "+j(t.availableNames.join("|"))+"  "+(null!==(e=t.description)&&void 0!==e?e:"")+"\n"},t.prototype.getArgumentStr=function(t){return"  ".concat(t.description?"<".concat(V(t.name),">  ").concat(t.description):"","\n")},t}(),ht=function(t,e,r){this.commandPart=t,this.middlewares=e,this.commandParams=r},bt=function(){function t(t,e){var r=this.parseOptionPattern(t),n=r.availableNames,o=r.mainName;this.availableNames=n,this.mainName=o,this.description=e}return t.prototype.parseOptionPattern=function(t){var e=t.split("|"),r=[],n="";if(e.forEach((function(t){var e;/(?<=-|--)@?[a-zA-Z0-9]+/.test(t)&&(e=t.replace(/-|--/g,"").trim(),/^@/.test(e)&&(e=e.slice(1).trim(),n=e),r.push(e))})),!r.length&&!n)throw Error("Incorrect option patern recieved(".concat(t,")"));return n||(n=r[0]),{availableNames:r,mainName:n}},t}();var yt=function(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))},vt=function(){function t(t,e,r,n){this.program=t,this.commandPart=e,this.middlewares=r,this.commandParams=n,this.formCommands()}return t.prototype.isDefaultMiddleware=function(t){return"function"==typeof t&&2===t.length},t.prototype.isErrorMiddleware=function(t){return"function"==typeof t&&3===t.length},t.prototype.divideMiddlewares=function(t){var e=this,r=[],n=[];return t.forEach((function(t){e.isDefaultMiddleware(t)&&r.push(t),e.isErrorMiddleware(t)&&n.push(t)})),{defaultMiddlewares:r,errorMiddlewares:n}},t.prototype.getNextFunction=function(t,e){var r=this.divideMiddlewares(e),n=r.defaultMiddlewares,o=r.errorMiddlewares,i=0,a=0,s=function(e){var r;e?(r=o[a++])&&r(e,t,s):(r=n[i++])&&r(t,s)};return s},t.prototype.addCommandByParams=function(t,e,r){var n=this;if(this.program.parser){var o=new gt(t,e.description);this.program.parser.addCommand(o),e.opts.forEach((function(t){var e=t.name,r=t.description;o.addOption(new bt(e,r))})),e.args.forEach((function(t){var e=t.name,r=t.description;o.addArgument(new dt(e,r))})),o.handle((function(t){n.getNextFunction(t,r)()}))}},t.prototype.formCommands=function(t,e,r){var n=this;void 0===t&&(t=""),void 0===e&&(e=this),void 0===r&&(r=[]);var o=yt([],r,!0);e.middlewares.forEach((function(e){if(e instanceof ht){var r=t+e.commandPart;n.formCommands(r,e,yt([],o,!0))}else"function"==typeof e&&o.push(e)})),e.commandParams&&this.addCommandByParams(t,e.commandParams,yt([],o,!0))},t}();const wt=vt;var Ot=new p(new u(new a(new i))),Bt=new ft("Bank-cli","CLI Application for bank management",Ot);Bt.addHelpTableCommand();var Ct=new ht("Banks",[function(t,e){console.log("get banks first middleware"),e("err"),console.log("after err")},function(t,e){console.log("get banks second middleware"),e()},function(t,e,r){console.log("get banks local error middleware ".concat(String(t)))}],{description:"Lists array of banks",opts:[],args:[]}),Pt=new ht("Comments",[function(t,e){console.log("get commments first middleware"),e("err"),console.log("after err")},function(t,e){console.log("get comments second middleware"),e()},function(t,e,r){console.log("get comments local error middleware ".concat(String(t)))}],{description:"Lists array of comments",opts:[{name:"-f|--@first",description:"Only first comment"}],args:[{name:"text",description:"text to search by"}]});new wt(Bt,"",[new ht("get",[function(t,e,r){console.log("get error ".concat(String(t))),r(t)},function(t,e){console.log("first get middleware"),e()},Pt,function(t,e){console.log("second get middleware"),e()},Ct],{description:"get something",opts:[{name:"-d|--@do",description:"do something"}],args:[{name:"text",description:"text to search by"}]})]),Ot.parse()})();